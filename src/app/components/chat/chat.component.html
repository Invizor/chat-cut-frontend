<div class="c-chat-window">
  <div class="header">
    <div class="add-thread-control">
      <i class="material-icons" (click)="openDialogNewThread()">add_circle_outline</i>
      <span (click)="openDialogNewThread()">New thread</span>
    </div>
    <div class="app-title">
      ChatCut
    </div>
    <div class="logo-control">
      <div class="icon-app-cut">
      </div>
      <button class="burger-control" mat-icon-button [matMenuTriggerFor]="menu">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item>
          <span>Settings</span>
        </button>
        <button mat-menu-item (click)="logoutUser()">
          <span>Logout</span>
        </button>
      </mat-menu>
    </div>
  </div>
  <div class="content">
    <div class="thread-list">
      <div
      [ngClass]="{'active-thread': thread._id === idSelectThread}"
      class="item-thread" *ngFor="let thread of listThreads"
      (click)="goToCurrentThread(thread._id)"
      >
        <div class="title-thread">
          {{thread.listIdUsers | listCommaEqualField : objUserNames}}
        </div>
        <div class="remove-icon">
          <i (click)="removeUserFromThread(thread._id, $event)" class="material-icons">clear</i>
        </div>
      </div>
    </div>
    <div class="window-messages" #scrollWindow>
      <div class="messages-list" *ngIf="currentThread">
        <div
        [ngClass]="{'my-message': message.idUser === user._id, 'not-my-message': message.idUser !== user._id}"
        class="message-item"
        *ngFor="let message of currentThread.messageList"
        >
          <div class="content-item">
            <div class="title">
              <div class="username">{{objUserNames[message.idUser]}}</div>
              <div class="date">{{message.date | dateTimeFormat}}</div>
            </div>
            <div class="text" [innerHTML]="message.text | prepareTextMessage"></div>
            <div class="remove-icon" *ngIf="message.idUser === user._id">
              <i (click)="removeMessage(message._id)" class="material-icons">clear</i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="control-footer">
    <div class="empty-block">

    </div>
    <div class="field-enter-text">
      <textarea [(ngModel)]="messageModel" (keyup.enter)="sendMessage()">
      </textarea>
    </div>
    <div class="control-send-message">
      <i (click)="sendMessage()" class="material-icons">send</i>
    </div>
  </div>

</div>
